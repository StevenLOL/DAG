original code was provided by Bi Wei, 1/19/2015.
